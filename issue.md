
# ToDo

# Done
- [x] Ctrl + Win のコンビネーションはホームポジションでは使いにくいので、発動条件をShift + Win に変更する。
- [x] Ctrl + Win または Win + Ctrl で Win + Ctrl + Right をソフト入力するようにする
- [x] Ctrl, Alt, Shift が押されている場合にWin単一押し機能が働かないようにする
- [x] 実際のキーボード操作を記憶し、押しっぱなしによるキーDownイベントと区別するように変更
    具体的な症状：Win + Rightの入力(Windowsキーを最後に離すパターン)の際、Rightキーを別のキーボード（テンキーパッド等）で入力すると、Win + Ctrl + Left がソフト入力されてしまう。
	原因：１つのキーを押し下げた際、そのキーコードが繰り返し入力され続けた状態となるが、その状態で同じキーボード上の別のキーを押し下げた際、前のキーの入力は途絶え、最後に押し下げたキーのみ繰り返し入力され続ける。
    しかし、２つ目のキーの押し下げを別のキーボードで行った場合、1つ目のキーと２つ目のキーの入力が交互に繰り返し入力され続ける(厳密に交互となるかは未調査だが、ここでは問題ではない)。
	現在、WindowsキーのDownとUpイベントの間に何もキー入力がなければ、Win + Ctrl + Left がソフト入力される動作となっている。
	Win + Right を単一キーボードで入力した場合、キーイベントは通常、Win Down(繰り返し), Right Down(繰り返し), Right Up, Win Downの順のため、Win DownとWin Upが連続で起こることはなく、上記ソフト入力は発火せず正常である。
	一方、Win + Right を２つのキーボードを使い入力した場合、Rightキーを離した後、押し下げたままのWindowsキーによってWin Downが繰り返し起こり、Windowsキーを離すと、Win Up が起こるため、上記ソフト入力が引き起こされてしまう。
	以上の考察より、Win Down の後、 別のキーDownが起こった場合、Win Up が起こるまでは Win Down を無視するようにする必要がある。
	

# Issue
- [ ] 『タスクトレイアイコン右クリックして「ウィンドウ表示」を選択』を繰り返し行うと、メインウィンドウが多重起動してしまう
- [ ] フックしたキー入力がWindowsキーのPushだった場合に、Win + Ctrl + Left がソフト入力されるが、フック内容が破棄されない。
- [ ] フックしたキー入力を別のキー入力に置き換えた際に、フック内容が破棄されない。